---
title: "est"
format: html
---

```{r}
tag = "1"
A = read.csv(paste("A_", tag, ".csv", sep = ""), header = FALSE)
Z = read.csv(paste("Z_", tag, ".csv", sep = ""), header = FALSE)
Y = read.csv(paste("Y_", tag, ".csv", sep = ""), header = FALSE)
```

```{r}
# fit factor-probit regression to get means and variances and b vector
# fix, fake for now
load(paste("param_", tag, ".RData", sep = ""))
```

```{r}
# compute M and d
z = rep(1,p)
M = t(lambda_common) %*% solve(lambda_unique) %*% lambda_common + solve(H_covar)

d = t(lambda_common) %*% solve(lambda_unique) %*% z + solve(H_covar) %*% H_mean

# compute expectation and variances

```

```{r}
# compute mu

# fit regression model to get betas

```

```{r}
# compute nu

```

```{r}
# compute CATE
```

