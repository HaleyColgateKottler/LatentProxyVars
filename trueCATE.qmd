---
title: "true_diff"
format: html
---

```{r}
tag = "1D"
load(paste("param_", tag, ".RData", sep = ""))
```

```{r}
psi_inv = solve(psi)
H_covar_inv = solve(H_covar)
lambda_psi = t(lambda) %*% psi_inv

z = rep(1,p)

M = lambda_psi %*% lambda + H_covar_inv
d = lambda_psi %*% (z-Z_intercept)
M_inv = solve(M)
M_inv%*%d

CATE = (C1-C2) %*% M_inv %*% d + C0
CATE
```

```{r}
ATE = C1

ATE
```

