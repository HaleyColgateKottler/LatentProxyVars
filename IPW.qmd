---
title: "IPW"
format: html
---
```{r}
tag = "1"
```


```{r}
A = read.csv(paste("A_", tag, ".csv", sep = ""), header = FALSE)
Z = read.csv(paste("Z_", tag, ".csv", sep = ""), header = FALSE)
Y = read.csv(paste("Y_", tag, ".csv", sep = ""), header = FALSE)

p = dim(Z)[2]

AZ = Z
AZ$A = A$V1

m1 = glm(formula = A ~ ., family = binomial(link = "logit"), data = AZ)
```

```{r}
x = predict(m1, newdata = Z, type="response")

EY1 = mean(unlist(A*Y/x))

EY0 = mean(unlist((1-A)*Y/(1-x)))

ATE = EY1-EY0
ATE
```